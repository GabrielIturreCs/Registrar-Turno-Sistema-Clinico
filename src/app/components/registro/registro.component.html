<div
  *ngIf="currentView === 'register'"
  class="container-fluid d-flex align-items-center justify-content-center bg-light"
>
  <div class="card shadow-lg" style="max-width: 600px; width: 100%">
    <div class="card-header text-center bg-success text-white">
      <h3><i class="fas fa-user-plus"></i> Registro de Usuario</h3>
    </div>
    <div class="card-body">
      <form [formGroup]="registerForm" (ngSubmit)="register()">
        <div class="row g-3">
          <div class="col-md-6 mb-3">
            <label for="regTipoUsuario" class="form-label fw-bold fs-6">Tipo de Usuario</label>
            <select class="form-select form-select-lg" id="regTipoUsuario" formControlName="tipoUsuario" required>
              <option value="paciente">Paciente</option>
              <option value="dentista">Dentista</option>
              <option value="administrador">Administrador</option>
            </select>
            <div *ngIf="isFieldInvalid('tipoUsuario')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('tipoUsuario') }}</small>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <label for="regUsuario" class="form-label fw-bold fs-6">Nombre de Usuario</label>
            <input type="text" class="form-control form-control-lg" id="regUsuario" formControlName="nombreUsuario" required placeholder="Usuario único" />
            <div *ngIf="isFieldInvalid('nombreUsuario')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('nombreUsuario') }}</small>
            </div>
          </div>
        </div>
        <div class="row g-3">
          <div class="col-md-6 mb-3">
            <label for="regNombre" class="form-label fw-bold fs-6">Nombre</label>
            <input type="text" class="form-control form-control-lg" id="regNombre" formControlName="nombre" required placeholder="Tu nombre" />
            <div *ngIf="isFieldInvalid('nombre')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('nombre') }}</small>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <label for="regApellido" class="form-label fw-bold fs-6">Apellido</label>
            <input type="text" class="form-control form-control-lg" id="regApellido" formControlName="apellido" required placeholder="Tu apellido" />
            <div *ngIf="isFieldInvalid('apellido')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('apellido') }}</small>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-3" *ngIf="registerForm.get('tipoUsuario')?.value === 'dentista'">
          <label for="regLegajo" class="form-label fw-bold fs-6">Legajo</label>
          <input type="text" class="form-control form-control-lg" id="regLegajo" formControlName="legajo" required placeholder="Legajo" />
          <div *ngIf="isFieldInvalid('legajo')" class="text-danger mt-2">
            <small class="fw-bold">{{ getFieldError('legajo') }}</small>
          </div>
        </div>
        <div class="row g-3">
          <div class="col-md-6 mb-3">
            <label for="regDni" class="form-label fw-bold fs-6">DNI</label>
            <input type="text" class="form-control form-control-lg" id="regDni" formControlName="dni" required placeholder="12345678" />
            <div *ngIf="isFieldInvalid('dni')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('dni') }}</small>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <label for="regTelefono" class="form-label fw-bold fs-6">Teléfono</label>
            <input type="tel" class="form-control form-control-lg" id="regTelefono" formControlName="telefono" placeholder="123456789" />
            <div *ngIf="isFieldInvalid('telefono')" class="text-danger mt-2">
              <small class="fw-bold">{{ getFieldError('telefono') }}</small>
            </div>
          </div>
        </div>
        <div class="mb-3" *ngIf="registerForm.get('tipoUsuario')?.value === 'paciente'">
          <label for="regObraSocial" class="form-label fw-bold fs-6">Obra Social</label>
          <select class="form-select form-select-lg" id="regObraSocial" formControlName="obraSocial" [required]="registerForm.get('tipoUsuario')?.value === 'paciente'">
            <option value="">Selecciona tu obra social</option>
            <option value="OSDE">OSDE</option>
            <option value="Swiss Medical">Swiss Medical</option>
            <option value="Galeno">Galeno</option>
            <option value="Medicus">Medicus</option>
            <option value="IOMA">IOMA</option>
            <option value="Particular">Particular</option>
          </select>
          <div *ngIf="isFieldInvalid('obraSocial')" class="text-danger mt-2">
            <small class="fw-bold">{{ getFieldError('obraSocial') }}</small>
          </div>
        </div>
        <div class="mb-3">
          <label for="regDireccion" class="form-label fw-bold fs-6">Dirección</label>
          <input type="text" class="form-control form-control-lg" id="regDireccion" formControlName="direccion" placeholder="Tu dirección completa" />
          <div *ngIf="isFieldInvalid('direccion')" class="text-danger mt-2">
            <small class="fw-bold">{{ getFieldError('direccion') }}</small>
          </div>
        </div>
        <div class="mb-3">
          <label for="regEmail" class="form-label fw-bold fs-6">Correo Electrónico</label>
          <input type="email" class="form-control form-control-lg" id="regEmail" formControlName="email" required placeholder="ejemplo@correo.com" />
          <div *ngIf="isFieldInvalid('email')" class="text-danger mt-2">
            <small class="fw-bold">{{ getFieldError('email') }}</small>
          </div>
        </div>
        <div class="mb-3">
          <label for="regPassword" class="form-label fw-bold fs-6">Contraseña</label>
          <input type="password" class="form-control form-control-lg" id="regPassword" formControlName="password" required placeholder="Contraseña segura" />
          <div *ngIf="isFieldInvalid('password')" class="text-danger mt-2">
            <small class="fw-bold">{{ getFieldError('password') }}</small>
          </div>
          <div *ngIf="registerForm.get('password')?.value" class="text-info mt-2">
            <small class="fw-bold">{{ passwordStrengthMessage }}</small>
          </div>
        </div>
        <div class="mb-3">
          <label for="regConfirmPassword" class="form-label fw-bold fs-6">Confirmar Contraseña</label>
          <input type="password" class="form-control form-control-lg" id="regConfirmPassword" formControlName="confirmPassword" required placeholder="Repite la contraseña" />
          <div *ngIf="registerForm.hasError('passwordMismatch') && (registerForm.get('confirmPassword')?.dirty || registerForm.get('confirmPassword')?.touched)" class="text-danger mt-2">
            <small class="fw-bold">Las contraseñas no coinciden</small>
          </div>
        </div>
        <div class="d-grid gap-3 d-md-flex justify-content-md-end mt-4">
          <button type="button" class="btn btn-secondary btn-lg me-md-2" (click)="navigateToLogin()">Cancelar</button>
          <button type="submit" class="btn btn-success btn-lg" [disabled]="registerForm.invalid || isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            {{ isLoading ? "Registrando..." : "Registrar" }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
